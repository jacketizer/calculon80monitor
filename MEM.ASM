; ******************************************************************************
; MEMORY MANAGEMENT DRIVER
; ******************************************************************************
; Driver:  Low level driver for memory testing and mappings
; ------------------------------------------------------------------------------

; Addresses
; ------------------------------------------------------------------------------
BANK		EQU	0x00		; Back switching device
BANK_RAM_VAL	EQU	0x01		; Switch out ROM
BANK_ROM_VAL	EQU	0x00		; Switch out RAM

; Variables
; ------------------------------------------------------------------------------
BANK_STATE_VAR	DEFB	0x00		; Storage for current state

; ------------------------------------------------------------------------------
; Title:      Switch in ROM
; Name:       MEM_ROM_IN
;
; Entry:      [No arguments]
; Exit:       [No value]
; Registers:  A
; ------------------------------------------------------------------------------
MEM_ROM_IN:
	LD	A,BANK_ROM_VAL
	LD	(BANK_STATE_VAR),A
	OUT	(BANK),A
	RET
; ------------------------------------------------------------------------------

; ------------------------------------------------------------------------------
; Title:      Switch out ROM
; Name:       MEM_ROM_OUT
;
; Entry:      [No arguments]
; Exit:       [No value]
; Registers:  A
; ------------------------------------------------------------------------------
MEM_ROM_OUT:
	LD	A,BANK_RAM_VAL
	LD	(BANK_STATE_VAR),A
	OUT	(BANK),A
	RET
; ------------------------------------------------------------------------------

; ------------------------------------------------------------------------------
; Title:      Get Bank State
; Name:       MEM_BANK_STATE

; Entry:      [No arguments]
; Exit:       A = 1 if RAM, else A = 0
; Registers:  A
; ------------------------------------------------------------------------------
MEM_BANK_STATE:
	LD	A,(BANK_STATE_VAR)
	RET
; ------------------------------------------------------------------------------

; ------------------------------------------------------------------------------
; END: Driver
; ------------------------------------------------------------------------------
